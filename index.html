<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Tutorly AI</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script>
    window.MathJax = {
      tex: {inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$', '$$'], ['\\[', '\\]']]}
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>

  <!-- AUTH UI -->
  <div id="auth-section" class="auth-overlay">
    <div class="auth-modal">
      <div class="auth-header">
        <h2>Welcome to Tutorly AI</h2>
        <p>Your AI-powered learning companion</p>
      </div>

      <div class="auth-tabs">
        <button class="auth-tab active" data-tab="signin">Sign In</button>
        <button class="auth-tab" data-tab="signup">Sign Up</button>
      </div>

      <div class="auth-form-container">
        <div class="auth-form active" id="signin-form">
          <div class="input-group">
            <input type="email" id="signin-email" placeholder="Enter your email" required>
            <!-- <label for="signin-email">Email</label> -->
          </div>
          <div class="input-group">
            <input type="password" id="signin-password" placeholder="Enter your password" required>
            <!-- <label for="signin-password">Password</label> -->
          </div>
          <button class="auth-button primary" id="sign-in">
            <span>Sign In</span>
            <div class="button-loader" style="display:none;"></div>
          </button>
        </div>

        <div class="auth-form" id="signup-form">
          <div class="input-group">
            <input type="email" id="signup-email" placeholder="Enter your email" required>
            <label for="signup-email">Email</label>
          </div>
          <div class="input-group">
            <input type="password" id="signup-password" placeholder="Create a password" required>
            <label for="signup-password">Password</label>
          </div>
          <button class="auth-button primary" id="sign-up">
            <span>Create Account</span>
            <div class="button-loader" style="display:none;"></div>
          </button>
        </div>
      </div>

      <div class="auth-footer">
        <p>ðŸ¤– Start chatting with your AI tutor in seconds!</p>
      </div>
    </div>
  </div>

  <!-- Sign Out Button (appears after login) -->
  <button id="sign-out" class="sign-out-btn" style="display:none;">Sign Out</button>

  <!-- CHAT UI -->
  <div id="chat-ui" style="display:none;">
    <div class="sidebar-overlay"></div>
    <div class="sidebar">
      <button id="new-chat">New Chat</button>
      <div id="chat-history"></div>
      <div id="struggle-tracker" style="margin-top:20px;padding:10px;background:#333;border-radius:8px;font-size:12px;">
        <h4 style="color:#0078d4;margin:0 0 8px;">ðŸ“Š Learning Progress</h4>
        <div id="struggle-list"></div>
      </div>
    </div>
    <button class="sidebar-toggle">â˜°</button>
    <div class="main">
      <div id="chat-window"></div>
      <form id="chat-form">
        <div class="input-container">
          <input type="text" id="user-input" placeholder="Type your message..." autocomplete="off" />
          <label for="file-input" class="file-upload-btn" title="Upload assignment">ðŸ“Ž</label>
          <input type="file" id="file-input" accept=".txt,.pdf,.doc,.jpg,.jpeg,.png" style="display:none;" />
          <button type="submit">Send</button>
        </div>
      </form>
    </div>
  </div>

  <script src="script.js"></script>
</body>

</html>
